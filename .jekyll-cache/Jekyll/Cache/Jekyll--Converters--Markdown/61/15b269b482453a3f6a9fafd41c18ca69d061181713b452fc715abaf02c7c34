I"À<h1 id="net_rx_action">net_rx_action</h1>
<p>è½¯ä¸­æ–­è§¦å‘ï¼Œå¼€å§‹æ¥æ”¶å¤„ç†å¸§é˜Ÿåˆ—
```c
static __latent_entropy void net_rx_action(struct softirq_action *h)
{
	struct softnet_data *sd = this_cpu_ptr(&amp;softnet_data); // è·å–ç»‘å®š CPU çš„ softnet_data
	unsigned long time_limit = jiffies + usecs_to_jiffies(netdev_budget_usecs); // å•æ¬¡å¤„ç†æ—¶é•¿é™åˆ¶
	int budget = netdev_budget; // å•æ¬¡å¤„ç† skb ä¸Šé™ï¼Œé»˜è®¤ 300
	LIST_HEAD(list); // ç§»åŠ¨åˆ°åˆ—è¡¨å¤´
	LIST_HEAD(repoll);
	local_irq_disable();
	list_splice_init(&amp;sd-&gt;poll_list, &amp;list);
	local_irq_enable();
	for (;;) {
		struct napi_struct *n; // 
		if (list_empty(&amp;list)) {
			if (!sd_has_rps_ipi_waiting(sd) &amp;&amp; list_empty(&amp;repoll))
				goto out;
			break;
		}
		n = list_first_entry(&amp;list, struct napi_struct, poll_list); // 
		budget -= napi_poll(n, &amp;repoll); // NAPI poll è™šæ‹Ÿå‡½æ•°å¤„ç†ï¼Œå¹¶è¿”å›å¤„ç†æ•°é‡
		if (unlikely(budget &lt;= 0 || time_after_eq(jiffies, time_limit))) {
			sd-&gt;time_squeeze++;
			break;
		}
	}
	local_irq_disable();
	list_splice_tail_init(&amp;sd-&gt;poll_list, &amp;list); // è¿æ¥ä¸¤ä¸ªåˆ—è¡¨ï¼Œå¹¶é‡æ–°åˆå§‹åŒ–ç©ºåˆ—è¡¨
	list_splice_tail(&amp;repoll, &amp;list); // è¿æ¥ä¸¤ä¸ªåˆ—è¡¨ï¼Œæ¯ä¸ªåˆ—è¡¨æ˜¯ä¸€ä¸ªé˜Ÿåˆ—
	list_splice(&amp;list, &amp;sd-&gt;poll_list);
	if (!list_empty(&amp;sd-&gt;poll_list))
		__raise_softirq_irqoff(NET_RX_SOFTIRQ);
	net_rps_action_and_irq_enable(sd);
out:
	__kfree_skb_flush();
}</p>
:ET