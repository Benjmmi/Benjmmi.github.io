I"¯<p>eBPF çš„ <strong><code class="language-plaintext highlighter-rouge">e</code></strong> å°±æ˜¯ extended çš„ç¼©å†™ã€‚æ‰€ä»¥ eBPF å°±æ˜¯ï¼ŒBPF å­—èŠ‚ç è¿‡æ»¤å™¨çš„å¢å¼ºç‰ˆã€‚</p>

<p>å­¦ä¹ å»ºè®®æ–¹å¼</p>
<ul>
  <li>åˆå­¦ä¼šç”¨ <code class="language-plaintext highlighter-rouge">bcc</code> å·¥å…·</li>
  <li>ä¸­çº§ä¼šç”¨ <code class="language-plaintext highlighter-rouge">bpftrace</code> å¼€å‘</li>
  <li>é«˜çº§å¼€å‘  <code class="language-plaintext highlighter-rouge">bcc</code> å·¥å…·ï¼Œå¹¶è´¡çŒ®</li>
</ul>

<p>Ubuntu å®‰è£… bcc ï¼š</p>
<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">sudo </span>apt-get <span class="nb">install </span>bpfcc-tools linux-headers-<span class="si">$(</span><span class="nb">uname</span> <span class="nt">-r</span><span class="si">)</span>
</code></pre></div></div>
<p>å…¶ä»–ç³»ç»Ÿå®‰è£… bcc å‚è€ƒï¼š<a href="https://github.com/iovisor/bcc/blob/master/INSTALL.md#ubuntu---binary">https://github.com/iovisor/bcc/blob/master/INSTALL.md#ubuntuâ€”binary</a></p>

<p>æ‰‹åŠ¨æŠ„ä¸€ä¸ª bcc çš„ Hello World</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#!/usr/bin/python
# Copyright (c) PLUMgrid, Inc.
# Licensed under the Apache License, Version 2.0 (the "License")
</span>
<span class="c1"># run in project examples directory with:
# sudo ./hello_world.py"
# see trace_fields.py for a longer example
</span>
<span class="kn">from</span> <span class="nn">bcc</span> <span class="kn">import</span> <span class="n">BPF</span>

<span class="c1"># This may not work for 4.17 on x64, you need replace kprobe__sys_clone with kprobe____x64_sys_clone
</span><span class="n">BPF</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s">'int kprobe__sys_clone(void *ctx) { bpf_trace_printk("Hello, World!</span><span class="se">\\</span><span class="s">n"); return 0; }'</span><span class="p">).</span><span class="n">trace_print</span><span class="p">()</span>
</code></pre></div></div>
<p>æˆåŠŸè¿è¡Œï¼Œè¾“å‡ºç»“æœï¼š</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>b' IPDL Background-5703    [003] ....  5087.572783: 0: Hello, World!'
b'     Web Content-13466   [003] ....  5087.634894: 0: Hello, World!'
b' gnome-session-b-1181    [000] ....  5128.625994: 0: Hello, World!'
b'           Timer-5685    [000] ....  5140.509352: 0: Hello, World!'
b' IPDL Background-5703    [003] ....  5140.966663: 0: Hello, World!'
b' Privileged Cont-5797    [001] ....  5140.968354: 0: Hello, World!'
</code></pre></div></div>

<p>åœ¨æŠ„ä¸€ä¸ªæœ€å…³å¿ƒçš„ networkï¼š<a href="https://github.com/iovisor/bcc/blob/master/examples/networking/http_filter/http-parse-simple.py">http-parse-simple.py</a></p>

<h1 id="ç›®å½•">ç›®å½•</h1>

<ul>
  <li><a href="/jony.github.io/9a44115ea383/">1. eBPF åŸºæœ¬äº†è§£å’Œå…¥é—¨</a></li>
  <li><a href="/jony.github.io/6b9c54247f6f/">2. eBPF ç¿»è¯‘æ–‡æ¡£åˆé›†</a></li>
  <li><a href="/jony.github.io/e83139ad9bf1/">3. eBPF å·¥å…·é“¾</a></li>
  <li><a href="/jony.github.io/3006e0a225f3/">4. C BPF ç¼–ç¨‹è§„èŒƒ</a></li>
  <li><a href="/jony.github.io/ada1626fa032/">5. iproute2</a></li>
  <li><a href="/jony.github.io/4b2ecddadcc3/">6. Program_Types</a></li>
  <li><a href="/jony.github.io/99a44d212429/">7. eBPF åº”ç”¨æ¡ˆä¾‹</a></li>
</ul>

<p>æ‰©å±•é˜…è¯»</p>

<ul>
  <li><a href="/jony.github.io/6ee15c371963/">æµé‡æ§åˆ¶ï¼šä»¤ç‰Œå’Œæ¡¶ç®—æ³•</a></li>
</ul>

<h1 id="å‚è€ƒæ–‡æ¡£">å‚è€ƒæ–‡æ¡£</h1>

<p><a href="https://www.kernel.org/doc/html/latest/bpf/bpf_devel_QA.html">å®˜æ–¹æ–‡æ¡£å¦‚ä½•ä¸BPFå­ç³»ç»Ÿäº¤äº’</a>
<a href="https://man7.org/linux/man-pages/man7/bpf-helpers.7.html">bpf-helpers</a>
<a href="https://www.kernel.org/doc/html/latest/bpf/bpf_design_QA.html#questions-and-answers">bpfå¸¸è§çš„è®¾è®¡é—®é¢˜</a>
<a href="http://sniffer.site/2019/11/07/BPF%E4%B8%8EeBPF/">BPFä¸eBPF</a>
<a href="https://man7.org/linux/man-pages/man7/bpf-helpers.7.html#NAME">bpf-helpers(7) â€” Linux manual page</a>
<a href="https://www.cnblogs.com/charlieroro/p/13403672.html">å…¨é¢ä»‹ç»eBPF-æ¦‚å¿µ</a>
<a href="https://facebookmicrosites.github.io/bpf/">facebook-bpf-support</a></p>
:ET