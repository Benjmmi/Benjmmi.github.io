<!DOCTYPE html>

<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
  
  <title>Linux 提交 patch [ Benjmmi 的博客 ]</title>
  
    <!-- stylesheets list from config.yml -->
    
      <link rel="stylesheet" href="/css/iLiKE.css">
    
  
  
<meta name="generator" content="Hexo 8.1.1"></head>
<body>
    <div class="header">
        <div class="container">
    <div class="menu">
      <div class="menu-left">
        <a href="/">
          <img src="/favicon.ico"></img>
        </a>
      </div>
      <div class="menu-right">
        
          
          
          
          
          
          
          <a href="/">首页</a>
        
          
          
          
          
          
          
          <a href="/archives">归档</a>
        
          
          
          
          
          
          
          <a href="/about">关于</a>
        
          
          
          
          
          
          <a target="_blank" rel="noopener" href="https://github.com/Benjmmi">Codes</a>
        
      </div>
    </div>
</div>
    </div>
    <div class="container">
        <h1 class="post-title">Linux 提交 patch</h1>
<article class="post markdown-style">
  <p>export HTTP_PROXY&#x3D;<a target="_blank" rel="noopener" href="http://192.168.0.102:58591/">http://192.168.0.102:58591</a>; export HTTPS_PROXY&#x3D;<a target="_blank" rel="noopener" href="http://192.168.0.102:58591/">http://192.168.0.102:58591</a>; export ALL_PROXY&#x3D;socks5:&#x2F;&#x2F;192.168.0.102:51837</p>
<p>Author: Jason Wang <a href="mailto:&#119;&#x61;&#x6e;&#x67;&#98;&#x6f;&#114;&#111;&#x6e;&#x67;&#x40;&#99;&#x64;&#106;&#x72;&#108;&#99;&#x2e;&#x63;&#111;&#109;">wangborong@cdjrlc.com</a><br>Date:   Tue Aug 17 20:11:06 2021 +0800</p>
<p>net: tcp_drop adds <code>reason</code>  v5</p>
<p>I used the suggestion from <code>Brendan Gregg</code>. In addition to the<br><code>reason</code> parameter there is also the <code>field</code> parameter pointing<br>to <code>SNMP</code> to distinguish the <code>tcp_drop</code> cause. I know what I<br>submitted is not accurate, so I am submitting the current<br>patch to get comments and criticism from everyone so that I<br>can submit better code and solutions.And of course to make me<br>more familiar and understand the <code>linux</code> kernel network code.<br>Thank you everyone!</p>
<p>git send-email 0001-net-tcp_drop-adds-reason-and-SNMP-parameters-for-tra.patch –to <a href="mailto:&#x32;&#50;&#x32;&#x38;&#x35;&#x39;&#56;&#55;&#56;&#x36;&#64;&#x71;&#x71;&#x2e;&#x63;&#111;&#109;">2228598786@qq.com</a></p>
<p>git send-email 0001-net-tcp_drop-adds-reason-and-SNMP-parameters-for-tra.patch –to <a href="mailto:&#x65;&#x64;&#x75;&#x6d;&#97;&#122;&#x65;&#116;&#64;&#x67;&#111;&#111;&#x67;&#108;&#x65;&#x2e;&#x63;&#x6f;&#x6d;">edumazet@google.com</a> –cc <a href="mailto:&#110;&#x65;&#x74;&#x64;&#x65;&#118;&#64;&#118;&#103;&#101;&#x72;&#46;&#107;&#101;&#114;&#110;&#101;&#x6c;&#46;&#x6f;&#114;&#103;">netdev@vger.kernel.org</a>,<a href="mailto:&#x6c;&#x69;&#110;&#117;&#x78;&#x2d;&#x6b;&#x65;&#x72;&#110;&#x65;&#108;&#x40;&#x76;&#x67;&#101;&#x72;&#46;&#107;&#x65;&#x72;&#x6e;&#x65;&#108;&#46;&#x6f;&#114;&#103;">linux-kernel@vger.kernel.org</a>,<a href="mailto:&#x6b;&#x75;&#x62;&#x61;&#x40;&#x6b;&#x65;&#114;&#x6e;&#101;&#x6c;&#46;&#111;&#114;&#x67;">kuba@kernel.org</a>,<a href="mailto:&#x72;&#x6f;&#115;&#116;&#101;&#x64;&#116;&#x40;&#103;&#x6f;&#x6f;&#x64;&#109;&#x69;&#115;&#x2e;&#x6f;&#114;&#x67;">rostedt@goodmis.org</a>,<a href="mailto:&#x6d;&#x69;&#110;&#x67;&#x6f;&#64;&#114;&#101;&#100;&#104;&#97;&#x74;&#46;&#99;&#111;&#x6d;">mingo@redhat.com</a>,<a href="mailto:&#x64;&#x61;&#x76;&#x65;&#x6d;&#x40;&#100;&#x61;&#118;&#x65;&#109;&#108;&#x6f;&#x66;&#116;&#x2e;&#110;&#x65;&#x74;">davem@davemloft.net</a>,<a href="mailto:&#x79;&#x6f;&#x73;&#104;&#102;&#x75;&#x6a;&#105;&#64;&#108;&#105;&#110;&#x75;&#x78;&#x2d;&#x69;&#x70;&#118;&#54;&#46;&#111;&#x72;&#103;">yoshfuji@linux-ipv6.org</a>,<a href="mailto:&#x64;&#x73;&#x61;&#x68;&#101;&#x72;&#x6e;&#64;&#107;&#101;&#114;&#110;&#101;&#x6c;&#46;&#x6f;&#x72;&#x67;">dsahern@kernel.org</a>,<a href="mailto:&#x68;&#x65;&#x6e;&#103;&#113;&#105;&#46;&#x63;&#x68;&#x65;&#x6e;&#64;&#103;&#x6d;&#97;&#105;&#x6c;&#x2e;&#99;&#x6f;&#109;">hengqi.chen@gmail.com</a>,<a href="mailto:&#121;&#104;&#115;&#x40;&#102;&#98;&#46;&#99;&#x6f;&#x6d;">yhs@fb.com</a>,<a href="mailto:&#x62;&#x72;&#x65;&#x6e;&#100;&#97;&#x6e;&#46;&#100;&#46;&#x67;&#114;&#101;&#103;&#x67;&#x40;&#x67;&#x6d;&#x61;&#x69;&#108;&#x2e;&#99;&#111;&#109;">brendan.d.gregg@gmail.com</a>,<a href="mailto:&#x32;&#x32;&#x32;&#56;&#x35;&#x39;&#x38;&#x37;&#x38;&#x36;&#x40;&#113;&#113;&#x2e;&#x63;&#111;&#x6d;">2228598786@qq.com</a></p>
<p>Author: Jason Wang <a href="mailto:&#x77;&#97;&#110;&#103;&#x62;&#111;&#x72;&#x6f;&#110;&#x67;&#64;&#x63;&#100;&#106;&#x72;&#x6c;&#99;&#x2e;&#x63;&#x6f;&#109;">wangborong@cdjrlc.com</a><br>Date:   Tue Aug 17 20:11:06 2021 +0800</p>
<p>net: tcp_drop adds <code>reason</code> parameter for tracing v2</p>
<p>In this version, fix and modify some code issues. Changed the reason for <code>tcp_drop</code> from an enumeration to a mask and enumeration usage in the trace output.<br>By shifting <code>__LINE__</code> left by 6 bits to accommodate the <code>tcp_drop</code> call method source, 6 bits are enough to use. This allows for a more granular identification of the reason for calling <code>tcp_drop</code> without conflicts and essentially without overflow.<br>Example.</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">enum &#123;</span><br><span class="line">TCP_OFO_QUEUE = 1</span><br><span class="line">&#125;</span><br><span class="line">reason = __LINE__ &lt;&lt; 6</span><br><span class="line">reason |= TCP_OFO_QUEUE</span><br></pre></td></tr></table></figure>
<p>Suggestions from Jakub Kicinski, Eric Dumazet, much appreciated.</p>
<p>Modified the expression of the enumeration, and the use of the output under the trace definition.<br>Suggestion from Steven Rostedt. Thanks.</p>
<p>net&#x2F;mlx4:  trailing whitespace</p>
<p>trailing whitespace</p>
<pre><code>Signed-off-by: Jason Wang &lt;wangborong@cdjrlc.com&gt;
Reviewed-by: Tariq Toukan &lt;tariqt@nvidia.com&gt;
Link: https://lore.kernel.org/r/20210817121106.44189-1-wangborong@cdjrlc.com
Signed-off-by: Jakub Kicinski &lt;kuba@kernel.org&gt;


net/mlx4: Use ARRAY_SIZE to get an array&#39;s size

The ARRAY_SIZE macro is defined to get an array&#39;s size which is
more compact and more formal in linux source. Thus, we can replace
the long sizeof(arr)/sizeof(arr[0]) with the compact ARRAY_SIZE.

Signed-off-by: Jason Wang &lt;wangborong@cdjrlc.com&gt;
Reviewed-by: Tariq Toukan &lt;tariqt@nvidia.com&gt;
Link: https://lore.kernel.org/r/20210817121106.44189-1-wangborong@cdjrlc.com
Signed-off-by: Jakub Kicinski &lt;kuba@kernel.org&gt;
</code></pre>
<p>0001-net-mlx4-tcp_drop-replace-of-tcp_drop_new.patch</p>
<p>Eric Dumazet <a href="mailto:&#x65;&#100;&#117;&#109;&#x61;&#122;&#101;&#116;&#64;&#x67;&#x6f;&#x6f;&#103;&#108;&#101;&#x2e;&#99;&#x6f;&#109;">edumazet@google.com</a> (maintainer:NETWORKING [TCP])<br>Steven Rostedt <a href="mailto:&#x72;&#111;&#x73;&#116;&#101;&#x64;&#116;&#x40;&#x67;&#x6f;&#111;&#100;&#x6d;&#105;&#115;&#46;&#111;&#x72;&#103;">rostedt@goodmis.org</a> (maintainer:TRACING)<br>Ingo Molnar <a href="mailto:&#109;&#105;&#x6e;&#103;&#x6f;&#64;&#114;&#x65;&#x64;&#x68;&#x61;&#x74;&#46;&#99;&#111;&#x6d;">mingo@redhat.com</a> (maintainer:TRACING)<br>“David S. Miller” <a href="mailto:&#x64;&#x61;&#118;&#101;&#109;&#x40;&#100;&#97;&#118;&#x65;&#109;&#x6c;&#111;&#x66;&#x74;&#x2e;&#x6e;&#101;&#116;">davem@davemloft.net</a> (maintainer:NETWORKING [IPv4&#x2F;IPv6])<br>Hideaki YOSHIFUJI <a href="mailto:&#121;&#111;&#115;&#104;&#102;&#x75;&#x6a;&#x69;&#64;&#108;&#105;&#110;&#117;&#x78;&#x2d;&#x69;&#x70;&#118;&#54;&#46;&#x6f;&#x72;&#103;">yoshfuji@linux-ipv6.org</a> (maintainer:NETWORKING [IPv4&#x2F;IPv6])<br>David Ahern <a href="mailto:&#100;&#x73;&#x61;&#x68;&#x65;&#x72;&#110;&#x40;&#x6b;&#101;&#114;&#x6e;&#101;&#x6c;&#x2e;&#x6f;&#x72;&#x67;">dsahern@kernel.org</a> (maintainer:NETWORKING [IPv4&#x2F;IPv6])<br>Jakub Kicinski <a href="mailto:&#107;&#x75;&#98;&#97;&#64;&#107;&#x65;&#114;&#110;&#101;&#108;&#46;&#111;&#x72;&#x67;">kuba@kernel.org</a> (maintainer:NETWORKING [GENERAL])<br><a href="mailto:&#x6e;&#101;&#x74;&#x64;&#x65;&#118;&#64;&#118;&#x67;&#x65;&#x72;&#46;&#107;&#101;&#114;&#x6e;&#x65;&#x6c;&#x2e;&#111;&#x72;&#103;">netdev@vger.kernel.org</a> (open list:NETWORKING [TCP])<br><a href="mailto:&#108;&#105;&#110;&#x75;&#x78;&#x2d;&#107;&#x65;&#x72;&#110;&#101;&#x6c;&#64;&#x76;&#103;&#101;&#114;&#46;&#x6b;&#101;&#x72;&#x6e;&#101;&#x6c;&#x2e;&#x6f;&#114;&#x67;">linux-kernel@vger.kernel.org</a> (open list)</p>
<p>git send-email 0001-net-tcp_drop-adds-reason-parameter-for-tracing-v2.patch –to <a href="mailto:&#50;&#50;&#50;&#56;&#x35;&#57;&#56;&#55;&#x38;&#x36;&#x40;&#113;&#113;&#46;&#99;&#111;&#x6d;">2228598786@qq.com</a></p>
<p>git send-email 0001-net-tcp_drop-adds-reason-parameter-for-tracing-v2.patch –to <a href="mailto:&#107;&#117;&#98;&#x61;&#64;&#x6b;&#101;&#x72;&#x6e;&#101;&#108;&#x2e;&#111;&#114;&#103;">kuba@kernel.org</a> –cc <a href="mailto:&#x6e;&#101;&#116;&#x64;&#101;&#118;&#64;&#118;&#x67;&#x65;&#x72;&#46;&#x6b;&#x65;&#x72;&#110;&#101;&#108;&#46;&#x6f;&#x72;&#103;">netdev@vger.kernel.org</a>,<a href="mailto:&#108;&#105;&#110;&#x75;&#120;&#45;&#x6b;&#101;&#x72;&#x6e;&#101;&#108;&#x40;&#x76;&#103;&#101;&#x72;&#x2e;&#107;&#x65;&#114;&#x6e;&#x65;&#108;&#x2e;&#111;&#114;&#103;">linux-kernel@vger.kernel.org</a>,<a href="mailto:&#x65;&#100;&#x75;&#109;&#97;&#x7a;&#x65;&#116;&#64;&#x67;&#x6f;&#111;&#x67;&#x6c;&#x65;&#x2e;&#x63;&#111;&#109;">edumazet@google.com</a>,<a href="mailto:&#114;&#111;&#x73;&#116;&#x65;&#100;&#x74;&#x40;&#103;&#111;&#111;&#x64;&#x6d;&#105;&#115;&#x2e;&#x6f;&#114;&#103;">rostedt@goodmis.org</a>,<a href="mailto:&#109;&#105;&#x6e;&#103;&#x6f;&#64;&#x72;&#101;&#x64;&#104;&#x61;&#116;&#x2e;&#99;&#x6f;&#109;">mingo@redhat.com</a>,<a href="mailto:&#100;&#x61;&#118;&#101;&#x6d;&#64;&#100;&#97;&#x76;&#x65;&#x6d;&#x6c;&#111;&#x66;&#116;&#x2e;&#110;&#x65;&#116;">davem@davemloft.net</a>,<a href="mailto:&#x79;&#x6f;&#115;&#x68;&#102;&#x75;&#x6a;&#x69;&#64;&#108;&#x69;&#x6e;&#117;&#120;&#45;&#x69;&#112;&#x76;&#54;&#x2e;&#111;&#114;&#103;">yoshfuji@linux-ipv6.org</a>,<a href="mailto:&#100;&#115;&#97;&#104;&#101;&#x72;&#110;&#x40;&#x6b;&#x65;&#x72;&#110;&#x65;&#108;&#x2e;&#x6f;&#114;&#x67;">dsahern@kernel.org</a>,<a href="mailto:&#104;&#x65;&#x6e;&#x67;&#113;&#x69;&#46;&#x63;&#x68;&#101;&#x6e;&#x40;&#103;&#x6d;&#97;&#x69;&#x6c;&#46;&#x63;&#111;&#109;">hengqi.chen@gmail.com</a>,<a href="mailto:&#121;&#104;&#115;&#64;&#x66;&#x62;&#46;&#99;&#x6f;&#x6d;">yhs@fb.com</a></p>
<p>git send-email 0001-net-tcp_drop-adds-reason-parameter-for-tracing.patch –to <a href="mailto:&#50;&#x32;&#50;&#56;&#x35;&#x39;&#56;&#55;&#x38;&#54;&#64;&#x71;&#x71;&#x2e;&#99;&#x6f;&#x6d;">2228598786@qq.com</a></p>
<p>.&#x2F;scripts&#x2F;checkpatch.pl 0001-net-mlx4-tcp_drop-replace-of-tcp_drop_new.patch<br>.&#x2F;scripts&#x2F;get_maintainer.pl 0001-net-mlx4-Use-ARRAY_SIZE-to-get-an-array-s-size.patch</p>
<p>enum tcp_drop_reason {<br>       TCP_OFO_QUEUE &#x3D; 1,<br>       TCP_DATA_QUEUE_OFO &#x3D; 2,<br>       TCP_DATA_QUEUE &#x3D; 3,<br>       TCP_PRUNE_OFO_QUEUE &#x3D; 4,<br>       TCP_VALIDATE_INCOMING &#x3D; 5,<br>       TCP_RCV_ESTABLISHED &#x3D; 6,<br>       TCP_RCV_SYNSENT_STATE_PROCESS &#x3D; 7,<br>       TCP_RCV_STATE_PROCESS &#x3D; 8<br>};</p>
<p>TRACE_EVENT(tcp_drop,</p>
<pre><code>TP_PROTO(struct sock *sk, struct sk_buff *skb, enum tcp_drop_reason reason),

TP_ARGS(sk, skb, reason),

TP_STRUCT__entry(
    __array(__u8, saddr, sizeof(struct sockaddr_in6))
    __array(__u8, daddr, sizeof(struct sockaddr_in6))
    __field(__u16, sport)
    __field(__u16, dport)
    __field(__u32, mark)
    __field(__u16, data_len)
    __field(__u32, snd_nxt)
    __field(__u32, snd_una)
    __field(__u32, snd_cwnd)
    __field(__u32, ssthresh)
    __field(__u32, snd_wnd)
    __field(__u32, srtt)
    __field(__u32, rcv_wnd)
    __field(__u64, sock_cookie)
    __field(__u32, reason)
),

TP_fast_assign(
    const struct tcphdr *th = (const struct tcphdr *)skb-&gt;data;
    const struct inet_sock *inet = inet_sk(sk);
    const struct tcp_sock *tp = tcp_sk(sk);

    memset(__entry-&gt;saddr, 0, sizeof(struct sockaddr_in6));
    memset(__entry-&gt;daddr, 0, sizeof(struct sockaddr_in6));

    TP_STORE_ADDR_PORTS(__entry, inet, sk);

    /* For filtering use */
    __entry-&gt;sport = ntohs(inet-&gt;inet_sport);
    __entry-&gt;dport = ntohs(inet-&gt;inet_dport);
    __entry-&gt;mark = skb-&gt;mark;

    __entry-&gt;data_len = skb-&gt;len - __tcp_hdrlen(th);
    __entry-&gt;snd_nxt = tp-&gt;snd_nxt;
    __entry-&gt;snd_una = tp-&gt;snd_una;
    __entry-&gt;snd_cwnd = tp-&gt;snd_cwnd;
    __entry-&gt;snd_wnd = tp-&gt;snd_wnd;
    __entry-&gt;rcv_wnd = tp-&gt;rcv_wnd;
    __entry-&gt;ssthresh = tcp_current_ssthresh(sk);
    __entry-&gt;srtt = tp-&gt;srtt_us &gt;&gt; 3;
    __entry-&gt;sock_cookie = sock_gen_cookie(sk);
    __entry-&gt;reason = reason;
),

TP_printk(&quot;src=%pISpc dest=%pISpc mark=%#x data_len=%d snd_nxt=%#x snd_una=%#x snd_cwnd=%u ssthresh=%u snd_wnd=%u srtt=%u rcv_wnd=%u sock_cookie=%llx reason=%d&quot;,
      __entry-&gt;saddr, __entry-&gt;daddr, __entry-&gt;mark,
      __entry-&gt;data_len, __entry-&gt;snd_nxt, __entry-&gt;snd_una,
      __entry-&gt;snd_cwnd, __entry-&gt;ssthresh, __entry-&gt;snd_wnd,
      __entry-&gt;srtt, __entry-&gt;rcv_wnd, __entry-&gt;sock_cookie, __entry-&gt;reason)
</code></pre>
<p>);</p>
<p>cp net&#x2F;ipv4&#x2F;tcp_input.c ..&#x2F;net-push&#x2F;net&#x2F;ipv4&#x2F;tcp_input.c<br>cp include&#x2F;trace&#x2F;events&#x2F;tcp.h ..&#x2F;net-push&#x2F;include&#x2F;trace&#x2F;events&#x2F;tcp.h<br>cp include&#x2F;net&#x2F;tcp.h ..&#x2F;net-push&#x2F;include&#x2F;net&#x2F;tcp.h</p>
<p>On Tue, Aug 24, 2021 at 5:08 PM Zhongya Yan <a href="mailto:&#121;&#x61;&#x6e;&#x32;&#50;&#50;&#56;&#53;&#x39;&#x38;&#55;&#x38;&#54;&#x40;&#103;&#109;&#x61;&#105;&#x6c;&#46;&#x63;&#111;&#x6d;">yan2228598786@gmail.com</a> wrote:</p>
<blockquote>
<blockquote>
</blockquote>
</blockquote>
<p> –cc <a href="mailto:&#x6e;&#101;&#116;&#x64;&#x65;&#x76;&#x40;&#118;&#103;&#101;&#114;&#46;&#x6b;&#101;&#114;&#x6e;&#x65;&#108;&#x2e;&#111;&#114;&#103;">netdev@vger.kernel.org</a>,<a href="mailto:&#x6c;&#105;&#110;&#117;&#120;&#x2d;&#107;&#101;&#114;&#x6e;&#x65;&#x6c;&#64;&#118;&#103;&#101;&#114;&#46;&#x6b;&#x65;&#114;&#x6e;&#x65;&#108;&#46;&#x6f;&#x72;&#x67;">linux-kernel@vger.kernel.org</a>,<a href="mailto:&#107;&#117;&#x62;&#97;&#x40;&#107;&#x65;&#114;&#x6e;&#101;&#108;&#x2e;&#x6f;&#x72;&#x67;">kuba@kernel.org</a>,<a href="mailto:&#109;&#x69;&#110;&#x67;&#x6f;&#64;&#x72;&#x65;&#x64;&#x68;&#x61;&#x74;&#x2e;&#99;&#111;&#x6d;">mingo@redhat.com</a>,<a href="mailto:&#x64;&#97;&#118;&#101;&#x6d;&#64;&#x64;&#x61;&#x76;&#101;&#x6d;&#108;&#111;&#x66;&#x74;&#x2e;&#110;&#101;&#x74;">davem@davemloft.net</a>,<a href="mailto:&#121;&#111;&#x73;&#104;&#x66;&#x75;&#x6a;&#105;&#x40;&#108;&#105;&#x6e;&#x75;&#120;&#45;&#x69;&#x70;&#118;&#x36;&#46;&#x6f;&#114;&#103;">yoshfuji@linux-ipv6.org</a>,<a href="mailto:&#100;&#x73;&#97;&#104;&#101;&#x72;&#110;&#x40;&#107;&#101;&#x72;&#110;&#101;&#x6c;&#x2e;&#111;&#114;&#x67;">dsahern@kernel.org</a>,<a href="mailto:&#x68;&#101;&#110;&#x67;&#113;&#x69;&#46;&#99;&#x68;&#101;&#x6e;&#x40;&#103;&#109;&#97;&#105;&#x6c;&#x2e;&#99;&#x6f;&#109;">hengqi.chen@gmail.com</a>,<a href="mailto:&#x79;&#104;&#115;&#x40;&#x66;&#98;&#46;&#99;&#111;&#x6d;">yhs@fb.com</a>,<a href="mailto:&#x32;&#x32;&#50;&#x38;&#53;&#x39;&#56;&#55;&#x38;&#x36;&#64;&#x71;&#x71;&#x2e;&#99;&#111;&#109;">2228598786@qq.com</a></p>
<p>mutt –to <a href="mailto:&#x65;&#100;&#x75;&#109;&#97;&#x7a;&#x65;&#116;&#64;&#x67;&#x6f;&#x6f;&#103;&#108;&#x65;&#x2e;&#99;&#x6f;&#x6d;">edumazet@google.com</a>,<a href="mailto:&#x72;&#x6f;&#x73;&#x74;&#101;&#100;&#x74;&#64;&#x67;&#111;&#x6f;&#100;&#109;&#x69;&#115;&#x2e;&#x6f;&#x72;&#x67;">rostedt@goodmis.org</a>,<a href="mailto:&#x62;&#x72;&#x65;&#x6e;&#x64;&#97;&#x6e;&#46;&#100;&#46;&#103;&#114;&#x65;&#x67;&#x67;&#64;&#x67;&#x6d;&#97;&#x69;&#108;&#46;&#x63;&#111;&#109;">brendan.d.gregg@gmail.com</a>, –cc <a href="mailto:&#x6e;&#x65;&#116;&#100;&#x65;&#x76;&#x40;&#x76;&#x67;&#101;&#x72;&#46;&#x6b;&#x65;&#114;&#110;&#101;&#x6c;&#x2e;&#x6f;&#x72;&#103;">netdev@vger.kernel.org</a>,<a href="mailto:&#x6c;&#105;&#x6e;&#117;&#120;&#45;&#x6b;&#x65;&#x72;&#110;&#x65;&#108;&#64;&#118;&#x67;&#x65;&#x72;&#46;&#107;&#101;&#x72;&#x6e;&#101;&#108;&#x2e;&#x6f;&#x72;&#103;">linux-kernel@vger.kernel.org</a>,<a href="mailto:&#x6b;&#117;&#98;&#97;&#64;&#x6b;&#101;&#x72;&#x6e;&#101;&#108;&#x2e;&#111;&#x72;&#103;">kuba@kernel.org</a>,<a href="mailto:&#109;&#x69;&#110;&#x67;&#111;&#64;&#x72;&#x65;&#100;&#x68;&#x61;&#116;&#x2e;&#x63;&#111;&#109;">mingo@redhat.com</a>,<a href="mailto:&#x64;&#97;&#118;&#101;&#109;&#64;&#100;&#x61;&#x76;&#101;&#x6d;&#108;&#111;&#x66;&#116;&#46;&#110;&#x65;&#x74;">davem@davemloft.net</a>,<a href="mailto:&#x79;&#111;&#115;&#104;&#102;&#x75;&#106;&#105;&#x40;&#108;&#105;&#110;&#117;&#120;&#x2d;&#105;&#112;&#x76;&#54;&#x2e;&#x6f;&#x72;&#103;">yoshfuji@linux-ipv6.org</a>,<a href="mailto:&#100;&#x73;&#97;&#104;&#101;&#114;&#x6e;&#64;&#x6b;&#101;&#114;&#x6e;&#101;&#108;&#46;&#111;&#x72;&#103;">dsahern@kernel.org</a>,<a href="mailto:&#121;&#x68;&#115;&#64;&#102;&#98;&#x2e;&#x63;&#111;&#109;">yhs@fb.com</a>,<a href="mailto:&#50;&#x32;&#x32;&#x38;&#53;&#x39;&#56;&#55;&#56;&#54;&#x40;&#x71;&#x71;&#x2e;&#x63;&#111;&#109;">2228598786@qq.com</a> -s “Re: [PATCH] net: tcp_drop adds `reason` and SNMP parameters for tracing v4”</p>
<p>Steven Rostedt <a href="mailto:&#x72;&#x6f;&#x73;&#116;&#101;&#100;&#116;&#x40;&#103;&#x6f;&#111;&#100;&#109;&#105;&#115;&#46;&#x6f;&#x72;&#x67;">rostedt@goodmis.org</a> wrote:</p>
<blockquote>
<p>Just curious. Is “Tcp” the normal way to write “TCP” in the kernel? I see<br>it in snmp_seq_show_tcp_udp() in net&#x2F;ipv4&#x2F;proc.c, but no where else<br>(besides doing CamelCase words). Should these be written using “TCP”<br>instead of “Tcp”. It just looks awkward to me.</p>
<p>But hey, I’m not one of the networking folks, so what do I know?</p>
<p>– Steve</p>
</blockquote>
<p>I will do it. I guess any other suggestions? I feel like my description may not be accurate.<br>Thanks.<br>    –Zhongya Yan</p>
<p>git send-email  0001-tcp-tcp_drop-adds-SNMP-and-reason-parameter-for-trac.patch –to <a href="mailto:&#101;&#100;&#x75;&#x6d;&#97;&#122;&#x65;&#x74;&#64;&#103;&#x6f;&#111;&#103;&#x6c;&#x65;&#46;&#99;&#111;&#109;">edumazet@google.com</a>,<a href="mailto:&#x72;&#111;&#x73;&#116;&#x65;&#x64;&#x74;&#x40;&#x67;&#x6f;&#111;&#x64;&#109;&#x69;&#115;&#x2e;&#111;&#114;&#x67;">rostedt@goodmis.org</a>,<a href="mailto:&#x62;&#x72;&#x65;&#110;&#x64;&#97;&#x6e;&#x2e;&#100;&#46;&#x67;&#x72;&#x65;&#x67;&#103;&#64;&#103;&#109;&#97;&#x69;&#x6c;&#46;&#x63;&#111;&#109;">brendan.d.gregg@gmail.com</a>, –cc <a href="mailto:&#110;&#101;&#116;&#100;&#x65;&#x76;&#64;&#x76;&#x67;&#x65;&#114;&#x2e;&#107;&#101;&#x72;&#x6e;&#x65;&#108;&#x2e;&#111;&#114;&#x67;">netdev@vger.kernel.org</a>,<a href="mailto:&#108;&#105;&#110;&#x75;&#x78;&#x2d;&#x6b;&#x65;&#x72;&#x6e;&#101;&#108;&#64;&#x76;&#x67;&#101;&#x72;&#x2e;&#x6b;&#x65;&#x72;&#x6e;&#x65;&#108;&#x2e;&#111;&#x72;&#x67;">linux-kernel@vger.kernel.org</a>,<a href="mailto:&#x6b;&#117;&#x62;&#97;&#64;&#x6b;&#101;&#114;&#110;&#x65;&#x6c;&#46;&#x6f;&#x72;&#x67;">kuba@kernel.org</a>,<a href="mailto:&#109;&#x69;&#110;&#x67;&#x6f;&#x40;&#x72;&#x65;&#100;&#104;&#x61;&#x74;&#x2e;&#99;&#x6f;&#109;">mingo@redhat.com</a>,<a href="mailto:&#x64;&#x61;&#118;&#101;&#109;&#x40;&#x64;&#x61;&#x76;&#x65;&#109;&#x6c;&#x6f;&#x66;&#116;&#x2e;&#110;&#101;&#x74;">davem@davemloft.net</a>,<a href="mailto:&#x79;&#111;&#115;&#x68;&#x66;&#x75;&#x6a;&#105;&#x40;&#108;&#105;&#110;&#x75;&#x78;&#45;&#105;&#x70;&#x76;&#54;&#x2e;&#111;&#x72;&#103;">yoshfuji@linux-ipv6.org</a>,<a href="mailto:&#100;&#115;&#x61;&#x68;&#x65;&#x72;&#110;&#64;&#107;&#x65;&#x72;&#110;&#101;&#108;&#x2e;&#x6f;&#x72;&#103;">dsahern@kernel.org</a>,<a href="mailto:&#x79;&#104;&#115;&#64;&#x66;&#x62;&#46;&#99;&#111;&#x6d;">yhs@fb.com</a>,<a href="mailto:&#x32;&#50;&#x32;&#x38;&#x35;&#x39;&#56;&#x37;&#x38;&#54;&#64;&#x71;&#113;&#x2e;&#x63;&#x6f;&#x6d;">2228598786@qq.com</a> </p>
<p>git send-email  0001-tcp-tcp_drop-adds-SNMP-and-reason-parameter-for-trac.patch –to <a href="mailto:&#x32;&#x32;&#x32;&#56;&#x35;&#57;&#56;&#x37;&#56;&#x36;&#64;&#x71;&#x71;&#46;&#x63;&#x6f;&#x6d;">2228598786@qq.com</a> </p>
<p>docker tag registry.aliyuncs.com&#x2F;google_containers&#x2F;kube-apiserver:v1.22.1 k8s.gcr.io&#x2F;kube-apiserver:v1.22.1<br>docker tag registry.aliyuncs.com&#x2F;google_containers&#x2F;kube-controller-manager:v1.22.1 k8s.gcr.io&#x2F;kube-controller-manager:v1.22.1<br>docker tag registry.aliyuncs.com&#x2F;google_containers&#x2F;kube-scheduler:v1.22.1 k8s.gcr.io&#x2F;kube-scheduler:v1.22.1<br>docker tag registry.aliyuncs.com&#x2F;google_containers&#x2F;kube-proxy:v1.22.1 k8s.gcr.io&#x2F;kube-proxy:v1.22.1<br>docker tag registry.aliyuncs.com&#x2F;google_containers&#x2F;pause:3.5 k8s.gcr.io&#x2F;pause:3.5<br>docker tag registry.aliyuncs.com&#x2F;google_containers&#x2F;etcd:3.5.0-0 k8s.gcr.io&#x2F;etcd:3.5.0-0<br>docker tag coredns&#x2F;coredns:v1.8.4 k8s.gcr.io&#x2F;coredns&#x2F;coredns:v1.8.4</p>
<p>&#x2F;&#x2F; 生成 Patch<br>git log filename<br>查看文件提交历史，确定子系统<br><a target="_blank" rel="noopener" href="https://www.dazhuanlan.com/doraemonfj/topics/1139017">这个讲的比较好</a></p>

</article>

    <div class="pagenator post-pagenator">
    
    
        <a class="extend prev post-prev" href="../../core/net/ip_forward/">上一篇</a>
    

    
    <p>上次更新 2025-11-06</p>
    
    
        <a class="extend next post-next" href="../../../../09/12/go/2022-09-12-Go%E6%8F%90%E5%8D%87%E7%A8%8B%E5%BA%8F%E6%80%A7%E8%83%BD%E5%B0%8FTips/">下一篇</a>
    
    </div>


    </div>
    <div class="footer">
        <div class="container">
    <div class="social">
	<ul class="social-list">
		
			
				
				
				<li>
					<a href="mailto:2228598786@qq.com" title="email" target="_blank">
					<i class="fa fa-email"></i>
					</a>
				</li>
			
		
			
		
			
		
			
		
			
		
			
		
			
				
				<li>
					<a href="https://github.com/Benjmmi" title="github" target="_self">
					<i class="fa fa-github"></i>
					</a>
				</li>
			
		
			
		
			
		
			
		
			
		
			
		
			
		
	</ul>
</div>
    <div class="copyright">
        <span>
            
            
            
                © Benjmmi 2017 - 2025
            
        </span>
    </div>
    <div class="power">
        <span>
            Powered by <a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a> & <a target="_blank" rel="noopener" href="https://github.com/CaiChenghan/iLiKE">iLiKE Theme</a>
        </span>
    </div>
    <script src="https://cdn.bootcss.com/jquery/3.3.1/jquery.js"></script>
    <!--page counter part-->
<script>
function addCount (Counter) {
    url=$('.article-date').attr('href').trim();
    title = $('.article-title').text().trim();
    var query = new AV.Query(Counter);
    //use url as unique idnetfication
    query.equalTo("url",url);
    query.find({
        success: function(results) {
            if (results.length>0) {
                var counter=results[0];
                counter.fetchWhenSave(true); //get recent result
                counter.increment("time");
                counter.save();
            } else {
                var newcounter=new Counter();
                newcounter.set("title",title);
                newcounter.set("url",url);
                newcounter.set("time",1);
                newcounter.save(null,{
                    success: function(newcounter) {
                        //alert('New object created');
                    }, error: function(newcounter,error) {
                        alert('Failed to create');
                    }
                })
            }
        },
        error: function(error) {
            //find null is not a error
            alert('Error:'+error.code+" "+error.message);
        }
    });
}
$(function() {
    var Counter=AV.Object.extend("Counter");
    //only increse visit counting when intering a page
    if ($('.article-title').length == 1) {
       addCount(Counter);
    }
    var query=new AV.Query(Counter);
    query.descending("time");
    // the sum of popular posts
    query.limit(10); 
    query.find({
        success: function(results) {
                for(var i=0;i<results.length;i++) {
                    var counter=results[i];
                    title=counter.get("title");
                    url=counter.get("url");
                    time=counter.get("time");
                    // add to the popularlist widget
                    showcontent=title+" ("+time+")";
                    //notice the "" in href
                    $('.popularlist').append('<li><a href="'+url+'">'+showcontent+'</a></li>');
                }
            },
        error: function(error) {
            alert("Error:"+error.code+" "+error.message);
        }
    });
});
</script>
</div>

  <script src='https://unpkg.com/mermaid@11.12.1/dist/mermaid.min.js'></script>
  <script>
    if (window.mermaid) {
      mermaid.initialize({theme: 'forest'});
    }
  </script>
    </div>
</body>
</html>
