---
layout: post
title: "Flowable 数据库架构"
keywords: ""
description: ""
tagline: ""
date: '2023-08-29 10:59:06'
category: linux
tags: linux
---
> {{ page.description }}

# Flowable 数据库架构

Flowable 引擎的表遵循一个常见的命名模式。每个引擎的模式在下面详细描述。

与 Flowable 开源代码库相关的数据库表名以 ACT_ 开头。特定于 Flowable Work 或 Engage 的数据库表以 FLW_ 为前缀。

常见的次要标识符
表名的第二部分（第一个'\_'之后）是两个字符的标识，指定表的具体用途。

GE_: GE 代表通用数据，用于各种用途。

RU_: RU 代表运行时。这些是包含尚未完成的流程、案例等的运行时数据的运行时表。Flowable 仅在执行期间存储运行时数据，并在实例结束后删除记录。这使得运行时表格小且快速。

HI_: HI 代表历史。这些表包含历史数据。当从运行时表中删除数据时，历史表仍然包含这些已完成实例的所有信息。

RE_: RE 代表仓库。带有此前缀的表包含关于模型和定义的静态信息。

# 常见后缀

Flowable 引擎通常创建一个部署，从而产生一个或多个定义。这是通过将模型（例如，流程模型、案例模型等）传递给引擎 API 来完成的。引擎解析模型的内容。一个部署可以有多个模型。因此，部署是相关定义的逻辑容器。

如果部署成功，则在以下表中创建以下条目：

<prefix>\_DEPLOYMENT: 一个条目表示成功的部署。作为部署的一部分创建的所有定义都引用此条目。

<prefix>\_DEPLOYMENT_RESOURCES: 存储与部署相关的模型的内容。当引擎重新启动并需要特定的定义时，将查询此表以根据模型重建运行时行为。

<prefix>\_DEF(INITION): 一个部署可以有多个定义。典型地，部署中的每个模型都有一个定义（例如，流程定义、案例定义、表单定义等）。表中包含引擎已知的所有定义，可以从中启动新的定义实例。

# 常见数据库表

原始数据库表（如 BPMN 和 IDM）使用 Flowable 模式和脚本进行版本管理。较新的引擎和表使用 Liquibase 进行表版本控制。与数据库模式管理相关的有两个 Liquibase 表：

<prefix>\_DATABASECHANGELOG: Liquibase 使用此表来跟踪已运行的更改集。

<prefix>\_DATABASECHANGELOGLOCK: Liquibase 使用此表确保一次只运行一个 Liquibase 实例。

注：Liquibase 是一个用于跟踪数据库模式更改的基于 Java 的框架。

# 应用引擎数据库表

应用引擎负责存储和部署应用定义。

应用引擎的数据库表以 ACT_APP_ 为前缀。

ACT_APP_DEPLOYMENT: 通过应用引擎部署应用模型时，将存储一个记录以指示此部署。部署的实际内容被引用并存储在 ACT_APP_DEPLOYMENT_RESOURCE 表中。

ACT_APP_DEPLOYMENT_RESOURCE: 此表包含组成应用部署的实际资源（以字节形式存储）。当引擎需要实际模型时，资源是从这个表中获取的。

ACT_APP_APPDEF: 应用模型导致应用定义。这个定义，像流程/案例/等，是成功部署到应用引擎的应用模型的表示。

Here's a translation of the provided information on Flowable's CMMN Engine, DMN, and Process Engine database tables:

# CMMN引擎数据库表格

Flowable CMMN引擎的数据库名称都以ACT_CMMN_开始。第二部分是指定表格用途的两个字符的表格名称。这个用途大致匹配服务API。

ACT_CMMN_: 没有额外前缀的表格包含静态信息，如案例定义、案例部署和资源。

ACT_CMMN_HI_: HI代表历史。这些是包含历史数据的表格，例如过去的案例实例、计划项等。

ACT_CMMN_HI_CASE_INST: 此表格包含CMMN引擎启动的每一个案例实例的条目。

ACT_CMMN_HI_MIL_INST: 此表格包含案例实例中达到的每一个里程碑的条目。

ACT_CMMN_HI_PLAN_ITEM_INST: 此表格包含作为案例实例执行的一部分创建的每一个计划项实例的条目。

ACT_CMMN_RU_: RU代表运行时。这些是包含案例实例、计划项等运行时数据的运行时表格。Flowable仅在案例实例执行期间存储运行时数据，并在案例实例结束时删除记录。这使得运行时表格小且易于查询。

ACT_CMMN_RU_CASE_INST: 此表格包含已启动且尚未完成的每一个案例实例的条目。

ACT_CMMN_RU_MIL_INST: 此表格包含作为正在运行的案例实例的一部分达到的每一个里程碑的条目。

ACT_CMMN_RU_PLAN_ITEM_INST: 案例实例执行由多个在案例定义中定义的计划项的实例组成。此表格包含在案例实例执行期间创建的每一个实例的条目。

ACT_CMMN_RU_SENTRY_PART_INST: 计划项实例可以有守护状态转换的哨兵。这样的哨兵可以包含多个部分，这些部分需要在状态更改发生之前得到满足。此表格存储满足此类哨兵的任何部分。

# DMN数据库表格

Flowable DMN的数据库名称都以ACT_DMN_开始。

ACT_DMN_DECISION_TABLE: 此表格包含部署的决策表的元数据，并与其他引擎的定义相对应。

ACT_DMN_HI_DECISION_EXECUTION: 此表格包含有关DMN决策表执行的审计信息。

# 流程引擎数据库表格

流程引擎的表格以ACT_开始。没有额外的前缀（如其他引擎：CMMN或DMN），因为这是第一个构建的引擎。也请注意，因为这个原因，其他引擎重用了一些表格。

- ACT_RU_: 包含进程实例及其相关数据的运行时数据。一旦流程实例完成，所有运行时数据都会从这些表格中删除。

	- ACT_RU_EXECUTION: 存储进程实例和指向进程实例当前状态的指针（称为执行）。

	- ACT_RU_ACTINST: 进程实例中的每一个活动都有此表格中的一行，以指示活动的当前状态。

	- ACT_RU_<TYPE>\_JOB: Flowable引擎使用作业表格来实现异步逻辑、定时器或历史处理。这些表格存储每个作业所需的数据。

	- ACT_RU_ENTITYLINK: 此表格存储实例的父子关系信息。例如，如果一个进程实例启动一个子案例实例，此关系将存储在此表格中。这使得关系的查询变得容易。

	- ACT_RU_EVENT_SUBSCR: 当流程定义使用事件（信号/消息/等或开始/中间/边界）时，引擎将其存储在此表格中的引用。这简化了查询哪些实例正在等待某种类型的事件的过程。

	- ACT_RU_IDENTITYLINK: 此表格存储有关用户或组及其与（进程/案例/等）实例的角色的数据。其他需要身份链接的引擎也使用此表格。

	- ACT_RU_TASK: 此表格包含运行实例的每一个未完成用户任务的条目。然后在查询用户的任务列表时使用此表格。CMMN引擎也使用此表格。

	- ACT_RU_VARIABLES: 此表格存储与实例相关的变量。CMMN引擎也使用此表格。

- ACT_HI_: 这些表格包含运行和完成的实例的历史数据。这些表格的名称遵循它们的运行时对应项的名称。模型在被保存时，会在此表中生成一个条目。


ACT_DE_DEPLOYMENT: 当设计模型部署到Flowable引擎时，会在此表中创建一个条目，表示部署的状态和元数据。

ACT_DE_DEPLOYMENT_RESOURCE: 存储与部署相关的设计模型的内容。当引擎需要特定的模型定义时，会查询此表。

# 行动引擎数据库表

行动引擎负责存储行动定义并创建和存储行动实例。行动是可以触发的项目，通常作为流程或案例实例的一部分创建，并在用户界面中显示。当触发时，它们执行与其行动定义相关的自定义逻辑。

行动引擎的数据库表前缀为 FLW_ACTION_。除了典型的部署和定义表格外，还有以下表格：

FLW_ACTION_INSTANCE: 类似于从流程/案例定义创建流程/案例实例，为给定的定义创建行动实例。它的条目存储在这个表中。

FLW_ACTION_DEF_LINK: 行动定义可以链接到其他实体，例如只在某个上下文中可见。此类关系存储在此表中。

FLW_ACTION_LINK: 同样，行动实例也可以有链接，这些关系存储在此处。

FLW_HI_ACTION_INSTANCE: 此表包含已完成行动实例的历史信息。

FLW_HI_ACTION_LINK: 此表包含不再活跃的关系的历史信息。

# 审计数据库表

审计引擎允许创建和查询业务事件的审计流。这些事件称为审计实例，通常在执行流程或案例实例期间创建。

审计引擎的数据库表前缀为 FLW_AUDIT_ 或 FLW_AU。除了典型的部署和定义表格外，还有以下表格：

FLW_AUDIT_INSTANCE: 此表中的每个条目代表一个业务事件。

# 内容引擎数据库表

内容引擎用于存储和查询内容。内容可以是文档、图片等。

内容引擎的数据库表前缀为 FLW_CO_。除了典型的部署和定义表格外，还有以下表格：

FLW_CO_CONTENT_ITEM: 内容的每一项都在这个表中有一个条目。

FLW_CO_CONTENT_OBJECT: 假设不使用内容的文件系统实现，包含内容项目的实际字节。

FLW_CO_CONTENT_METADATA: 内容项可以有关联的元数据（例如作者、创建数据等）。此类元数据存储在此表中。

FLW_CO_CONTENT_RENDITION_ITEM: 一些内容可以用不同的方式表示，这称为呈现。例如，Word文档可能获得PDF呈现或缩略图PNG呈现。此表为内容项存储此类呈现信息。

# 数据对象引擎数据库表

对象引擎用于存储和查询对象。这些表与主数据处理一起使用。

数据对象引擎的数据库表前缀为 FLW_DO_ 或 FLW_DATAOBJECT_。

# Engage引擎数据库表

Engage引擎支持对话和消息。

Engage引擎的数据库表前缀为 FLW_ENGAGE_。目前有一个表不遵循该模式，FLW_CONV，将来将使用通用前缀。

除了典型的部署和定义表格外，Engage中的表格有如CONVERSATION、MESSAGE/CONVERSATION_STATUS等自解释的名称。

# 表单引擎数据库表

表单引擎存储围绕表单模型和这些表单的实例的数据。

表单引擎的数据库表前缀为 FLW_FO_。这里的表格有典型的部署、定义和实例名称。

# 身份引擎数据库表

IDM（身份管理引擎）存储有关用户和组的数据。

身份引擎的数据库表前缀为 FLW_ID_。

FLW_ID_USER_DEFINITIONS: 每个Flowable用户都有一个用户定义。这个定义定义了用户的角色、为用户启用的功能、用户是如何创建的等。

FLW_ID_USER: 此表为系统中定义的每个用户包含一个条目。

FLW_ID_GROUP: 此表为系统中定义的每个组包含一个条目。

FLW_ID_MEMBERSHIP: 此表映射用户和组之间的关系。即，哪些用户是哪些组的一部分。

FLW_ID_TOKEN: 当用户成功登录时，作为会话数据的一部分存储一个令牌。集群中的每个服务器都可以查询这个数据库表来协调每个服务器上的用户会话。

FLW_IDENTITY_INFO_: 此表存储与FLW_ID_USER表中未存储的用户相关的非结构化数据。

FLW_ID_USER_ACCOUNT_DEFINITIONS: 此表存储有关其他系统的第三方用户帐户的信息。

FLW_ID_USER_ACCOUNT: 此表存储用户帐户定义的特定实例。它包含指定帐户在第三方系统中的具体用户帐户详情。

FLW_ID_PRIV: 目前未使用。

FLW_ID_PRIV_MAPPING: 目前未使用。

# 策略引擎数据库表

策略引擎负责执行对象的用户访问权限。数据库表前缀为 FLW_POLICY_。

# 服务引擎数据库表

服务引擎用于存储、查询和执行服务定义。服务定义描述了服务有什么操作，预期什么参数以及如何调用服务。使用这些定义，流程或案例模型器可以使用这些服务，而无需知道实现细节（例如REST服务、表达式等）。数据库表前缀为 FLW_SE_。


# Flowable Insight 数据库表
Flowable Insight的表前缀为FLW_INSIGHT_。

FLW_INSIGHT_DATA_SOURCE: 存储与Flowable Insight连接的数据源的详细信息。

FLW_INSIGHT_REPORT: 此表存储生成的报告的元数据，包括报告的来源、创建日期等。

FLW_INSIGHT_DASHBOARD: 用户在Flowable Insight中创建的仪表板的元数据存储在此表中。

FLW_INSIGHT_WIDGET: 每个仪表板都可以包含多个小部件。每个小部件的配置和数据源信息都存储在此表中。

Flowable Analytics 数据库表
Flowable Analytics的表前缀为FLW_ANALYTICS_。

FLW_ANALYTICS_EVENT: 所有发送到Flowable Analytics的事件都存储在此表中，以进行进一步的处理和分析。

FLW_ANALYTICS_EVENT_HISTORY: 当事件被处理或分析后，其历史数据被存储在此表中。

注意：上面的描述是对Flowable数据库模式的简化版本。Flowable是一个强大的BPMN工作流引擎，它包括多个组件和引擎，每个引擎都有自己的数据库模式和表结构。这是一个非常详细的数据库模式说明，如果你需要更多详细的信息或有关Flowable的其他方面的问题，请告诉我！


# 代码清单
行内代码应用 `code`
```bash
$ ls -alh
```
# 图片
![](){:width="100%"}

---
参考：
- [](){:target='blank'}
- [](){:target='blank'}
