clang -g -O2 -target bpf -D__TARGET_ARCH_x86 -I.output -I../../libbpf/include/uapi -I../../vmlinux/ \
-idirafter /usr/local/include \
-idirafter /usr/lib/llvm-11/lib/clang/11.1.0/include \
-idirafter /usr/include/x86_64-linux-gnu \
-idirafter /usr/include \
-c url_map.bpf.c \
-o url_map.bpf.o


cc -g -Wall -I.output -I../../libbpf/include/uapi -I../../vmlinux/ -c url_map_read.c -o .output/url_map_read.o && cc -g -Wall .output/url_map_read.o /home/vagrant/libbpf-bootstrap/examples/c/.output/libbpf.a -lelf -lz -o url_map_read

cc -g -Wall -I.output -I../../libbpf/include/uapi -I../../vmlinux/ -c url_map.c -o .output/url_map.o && cc -g -Wall .output/url_map.o /home/vagrant/libbpf-bootstrap/examples/c/.output/libbpf.a -lelf -lz -o url_map

tc filter add dev eth0 ingress bpf da obj url_map.bpf.o sec ingress
tc filter add dev eth0 ingress bpf da obj url_map.bpf.o

sudo tc qdisc add dev eth0 clsact


sudo tc filter del dev eth0 ingress
sudo ip link set dev eth0 xdp off
sudo tc qdisc del dev eth0 clsact
sudo ip link set dev eth0 xdp off && sudo tc qdisc del dev eth0 clsact && sudo ./url_map


sudo cat /sys/kernel/debug/tracing/trace_pipe



clang -g -O2 -target bpf -D__TARGET_ARCH_x86 -I.output -I../../libbpf/include/uapi -I../../vmlinux/ \
-idirafter /usr/local/include \
-idirafter /usr/lib/llvm-11/lib/clang/11.1.0/include \
-idirafter /usr/include/x86_64-linux-gnu \
-idirafter /usr/include \
-c openat.bpf.c \
-o openat.bpf.o

cc -g -Wall -I.output -I../../libbpf/include/uapi -I../../vmlinux/ -c url_map_read.c -o .output/url_map_read.o && cc -g -Wall .output/url_map_read.o /home/vagrant/libbpf-bootstrap/examples/c/.output/libbpf.a -lelf -lz -o url_map_read


git pull && clang -g -O2 \
-target bpf \
-D__TARGET_ARCH_x86 \
-I.output \
-I../../libbpf/include/uapi \
-I../../vmlinux/ \
-idirafter /usr/local/include \
-idirafter /usr/lib/llvm-11/lib/clang/11.1.0/include \
-idirafter /usr/include/x86_64-linux-gnu \
-idirafter /usr/include \
-c trace_consume_skb.bpf.c \
-o .output/trace_consume_skb.bpf.o \
&& llvm-strip -g .output/trace_consume_skb.bpf.o \
&& /home/vagrant/libbpf-bootstrap/tools/bpftool \
gen skeleton .output/trace_consume_skb.bpf.o > .output/trace_consume_skb.skel.h


cc -g -Wall -I.output -I../../libbpf/include/uapi \
-I../../vmlinux/ -c trace_consume_skb.c \
-o .output/trace_consume_skb.o \
&& cc -g -Wall .output/trace_consume_skb.o \
/home/vagrant/libbpf-bootstrap/examples/c/.output/libbpf.a \
-lelf -lz -o trace_consume_skb





git pull && clang -g -O2 \
-target bpf \
-D__TARGET_ARCH_x86 \
-I.output \
-I../../libbpf/include/uapi \
-I../../vmlinux/ \
-idirafter /usr/local/include \
-idirafter /usr/lib/llvm-11/lib/clang/11.1.0/include \
-idirafter /usr/include/x86_64-linux-gnu \
-idirafter /usr/include \
-c kprobe_consume_skb.bpf.c \
-o .output/kprobe_consume_skb.bpf.o \
&& llvm-strip -g .output/kprobe_consume_skb.bpf.o \
&& /home/vagrant/libbpf-bootstrap/tools/bpftool \
gen skeleton .output/kprobe_consume_skb.bpf.o > .output/kprobe_consume_skb.skel.h


cc -g -Wall -I.output -I../../libbpf/include/uapi \
-I../../vmlinux/ -c kprobe_consume_skb.c \
-o .output/kprobe_consume_skb.o \
&& cc -g -Wall .output/kprobe_consume_skb.o \
/home/vagrant/libbpf-bootstrap/examples/c/.output/libbpf.a \
-lelf -lz -o kprobe_consume_skb














git pull && clang -g -O2 \
-target bpf \
-D__TARGET_ARCH_x86 \
-I.output \
-I../../libbpf/include/uapi \
-I../../vmlinux/ \
-idirafter /usr/local/include \
-idirafter /usr/lib/llvm-11/lib/clang/11.1.0/include \
-idirafter /usr/include/x86_64-linux-gnu \
-idirafter /usr/include \
-c openat.bpf.c \
-o .output/openat.bpf.o \
&& llvm-strip -g .output/openat.bpf.o \
&& /home/vagrant/libbpf-bootstrap/tools/bpftool \
gen skeleton .output/openat.bpf.o > .output/openat.skel.h


cc -g -Wall -I.output -I../../libbpf/include/uapi \
-I../../vmlinux/ -c openat.c \
-o .output/openat.o \
&& cc -g -Wall .output/openat.o \
/home/vagrant/libbpf-bootstrap/examples/c/.output/libbpf.a \
-lelf -lz -o openat